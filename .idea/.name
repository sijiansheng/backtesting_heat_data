count_and_diff_heat